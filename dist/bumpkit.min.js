!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Bumpkit=e()}}(function(){return function e(t,n,r){function i(a,u){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t){var n=function(){var e=this,t=e.createAnalyser();t.fftSize=32;var n=t.frequencyBinCount,r=new Uint8Array(n);return t.amp=function(){return t.getByteTimeDomainData(r),r[0]},t};t.exports={createAmplitudeAnalyser:n}},{}],2:[function(e,t){var n=function(e){var t=this,e=e||{},n=function(){this.duration=e.duration||.0625,this.output=e.output||t.destination,this.envelope=function(){t.createGain()};var n=e.frequency||256;this.frequency=function(e){return n=n,e?(n=e,this):n},this.connect=function(e){return this.output=e,this},this.play=function(e){var n=t.createOscillator();return n.type=0,n.frequency.value=this.frequency(),n.connect(this.output),t.trigger(n,{when:e,duration:this.duration}),this}};return new n};t.exports={createBeep:n}},{}],3:[function(e,t){var n=function(e){var e=e||{},t={};return t.output=e.output||0,t.active=e.active||!0,t.pattern=e.pattern||[],t.connect=function(e){t.output=e},t.play=function(e){t.output.play(e)},t.toggle=function(){t.active=!t.active},window.addEventListener("step",function(e){var n=e.detail.step,r=e.detail.when;t.active&&1==t.pattern[n]&&t.play(r)}),t};t.exports={createClip:n}},{}],4:[function(e,t){var n=function(){var e=this;this.tempo=120,this.isPlaying=!1,this.loopLength=null,this.timeSignature=[4,4],this.stepResolution=16;var t=function(){return 60/e.tempo/4},n=0,r=0,i=0,o=new CustomEvent("step",{detail:{}}),a=function(t){if(!e.currentTime){e.createBufferSource()}o.detail.step=r,o.detail.when=t,window.dispatchEvent(o)},u=function(){for(var o=.1,c=25;n<e.currentTime+o;)a(n),n+=t(),r++,r==e.loopLength&&(r=0);i=setTimeout(function(){u()},c)},c=function(){e.isPlaying=!1,window.clearTimeout(i)};return this.playPause=function(){e.isPlaying?c():(r=0,n=e.currentTime,u(),e.isPlaying=!e.isPlaying)},this};t.exports=n},{}],5:[function(e,t){var n=e("./clock"),r=e("./mixer"),i=e("./clip"),o=e("./beep"),a=e("./sampler"),u=e("./peak-analyser"),c=e("./analyser"),f=function(){var e=new(window.AudioContext||window.webkitAudioContext);return e.trigger=function(e,t){var t={when:t.when||0,offset:t.offset||0,duration:t.duration||0};e.start(t.when,t.offset||0),t.duration&&e.stop(t.when+t.duration)},e.buffers={},e.loadBuffer=function(e,t){function n(n){i.decodeAudioData(n,function(n){i.buffers[e]=n,t&&t(n)})}function r(e,t){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.open("GET",e,!0),n.send(),n.onload=function(){n.response||console.error("Could not load"),t(n.response)}}var i=this;this.buffers[e]&&t&&t(this.buffers[e]),r(e,function(e){n(e)})},e.initClock=n,e.initClock(),e.createMixer=r.createMixer,e.createBeep=o.createBeep,e.createSampler=a.createSampler,e.createClip=i.createClip,e.createAmplitudeAnalyser=c.createAmplitudeAnalyser,e.analysePeaks=u.analysePeaks,e};t.exports=f},{"./analyser":1,"./beep":2,"./clip":3,"./clock":4,"./mixer":6,"./peak-analyser":7,"./sampler":8}],6:[function(e,t){var n=function(){var e=this,t={},n=function(){var t=e.createGain();return t.effectsNode=e.createGain(),t.mute=e.createGain(),t.volume=e.createGain(),t.effects=[],t.connect(t.effectsNode),t.effectsNode.connect(t.mute),t.mute.connect(t.volume),t.updateConnections=function(){if(t.effectsNode.disconnect(0),t.effects.length>0){t.effectsNode.connect(t.effects[0]);for(var e=0;e<t.effects.length-1;e++){console.log("multiple effects",e);var n=t.effects[e+1];t.effects[e].disconnect(0),t.effects[e].connect(n)}t.effects[t.effects.length-1].connect(t.mute)}else t.effectsNode.connect(t.mute)},t.addEffect=function(e,n){var r=n||t.effects.length;t.effects.splice(r,0,e),t.updateConnections()},t.removeEffect=function(e){t.effects.splice(e,1),t.updateConnections()},t.connect=function(e){t.volume.connect(e)},t.toggleMute=function(){t.mute.gain.value=1-t.mute.gain.value},t};return t.master=new n,t.master.connect(e.destination),t.tracks=[],t.addTrack=function(){var e=new n;return e.connect(t.master),t.tracks.push(e),this},t.removeTrack=function(t){e.tracks.splice(t,1)},t};t.exports={createMixer:n}},{}],7:[function(e,t){var n=function(e){for(var t=256,n=e.length/t,r=~~(n/10)||1,i=e.numberOfChannels,o=new Float32Array(t),a=0;i>a;a++)for(var u=e.getChannelData(a),c=0;t>c;c++){for(var f=~~(c*n),s=~~(f+n),l=0,p=f;s>p;p+=r){var d=u[p];d>l?l=d:-d>l&&(l=-d)}(0==a||l>o[c])&&(o[c]=l)}return o};t.exports={analysePeaks:n}},{}],8:[function(e,t){var n=function(e){var t=this,e=e||{},n=function(){this.output=e.output||t.destination,this.offset=e.offset||0,this.duration=e.duration||.6,this.buffer=e.buffer||0,this.connect=function(e){this.output=e},this.play=function(e){var n=t.createBufferSource();n.buffer=this.buffer,n.connect(this.output),t.trigger(n,{when:e,duration:this.duration})}};return new n};t.exports={createSampler:n}},{}]},{},[5])(5)});